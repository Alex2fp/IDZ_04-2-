# Симуляция болтунов (C, POSIX threads)

Программа моделирует N болтунов с телефонами. Каждый поток:
- случайно ждёт или инициирует звонок;
- если линия адресата занята, мгновенно пытается другой номер;
- разговаривает случайное время, после чего может отключиться;
- завершает работу корректно по Ctrl+C, по тайм-ауту или как последний участник.

Доступны две реализации синхронизации:
1. `semaphore` — только мьютексы и семафоры.
2. `condition` — условные переменные, барьеры и атомарные флаги.

Логи пишутся одновременно в консоль и файл, отражая все ключевые события: набор номера, занятые линии, начало/конец разговора, уход болтунов и финал симуляции.

## Сборка

```bash
make           # сборка talkers
make clean     # очистка
```

## Запуск

Ключи CLI перекрывают значения конфигурационного файла (формат `key=value`).

```bash
./talkers --mode semaphore -n 5 \
  --min-idle 150 --max-idle 700 \
  --min-call 300 --max-call 900 \
  --leave-probability 0.2 \
  --duration 6 \
  --output outputs/run.log
```

Чтение параметров из файла:

```bash
./talkers --config configs/semaphore.conf
./talkers --config configs/condition.conf --mode condition
```

Основные параметры:
- `--mode <semaphore|condition>` — выбор реализации;
- `-n, --talkers` — число болтунов (1–64);
- `--min-idle`, `--max-idle` — пауза ожидания перед действием, мс;
- `--min-call`, `--max-call` — длительность разговора, мс;
- `--stop-after-calls` — гарантированное отключение после указанного числа разговоров (0 — отключение не обязательно);
- `--leave-probability` — вероятность ухода после разговора;
- `--duration` — ограничение по времени работы в секундах (0 — без ограничения);
- `--output` — файл лога (пустая строка — только консоль);
- `--config` — путь к конфигу `key=value`.

## Примеры конфигураций и результатов

- `configs/semaphore.conf` → `outputs/sample_semaphore.log`
- `configs/condition.conf` → `outputs/sample_condition.log`
- `configs/balanced.conf` → `outputs/sample_balanced.log`

Каждый лог отражает полноценный сеанс с повторными наборами при занятости линий, случайными длительностями разговоров и децентрализованным отключением последнего болтуна.
